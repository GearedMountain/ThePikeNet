{% extends 'base.html' %}

{% block content %}
<style>
#image-container{
  display: flex; 
  flex-wrap: wrap;     
  max-width: 400px;        
  margin: 0 auto;
}

#image-container div{
  margin: 2%;
  width: 46%;
  height: 46%;
  object-fit: cover; 
}
</style>
<body>
  <!--<h1 class="space-mono-bold">Universal Yums</h1>-->
  <div >
    <img class="mx-auto max-h-[10vh]" src="{{ url_for('static', filename='images/SnackboxLogo.svg') }}"/> 
    <p class="mx-auto w-auto">User: {{ username }}</p>
  </div>
  <main class="bg-[#0133a3] mt-2">
    <div class="mx-[400px]" id="image-container"></div>
  </main>
</body>
<script>
  // Fetch the JSON list of images
  fetch('/snackbox/image-list')
      .then(response => response.json())
      .then(images => {
          const container = document.getElementById('image-container');

          images.forEach(url => {
              const wrapper = document.createElement('div');
              wrapper.style.display = 'flex';
              wrapper.style.flexDirection = 'column';
              wrapper.style.alignItems = 'center';

              const img = document.createElement('img');
              img.src = "image/" + url;
              img.alt = 'url';
              container.appendChild(img);

              const fileName = url.split('/').pop() || '';
              const cleaned = fileName
              .replace(/\.(jpg|jpeg|png|gif)$/i, '') 
              .replace(/_/g, ' '); 

               const captionText = cleaned
              .split(' ')
              .map(word => word.charAt(0).toUpperCase() + word.slice(1))
              .join(' ');

              const caption = document.createElement('h3');
              caption.textContent = captionText;
              caption.classList.add("space-mono-bold");
              caption.style.color = "white";
              caption.style.textAlign = 'center';
              caption.style.wordBreak = 'break-word';

              wrapper.appendChild(img);
              wrapper.appendChild(caption);
              container.appendChild(wrapper);
          });
      })
      .catch(error => {
          console.error('Error fetching images:', error);
      });
</script>
  {% endblock %}
