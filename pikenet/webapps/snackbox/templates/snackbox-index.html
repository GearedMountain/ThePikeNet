{% extends 'base.html' %}

{% block content %}
<style>
#image-container {
  display: flex; 
  flex-wrap: wrap;     
  max-width: 400px;        
  margin: 0 auto;
}

#image-container div {
  margin: 2%;
  width: 46%;
  height: 46%;
  object-fit: cover; 
}

.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.7); /* slightly opaque black */
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  color: white;
  font-size: 2em;
  z-index: 9999; /* ensure itâ€™s on top */
}

.no-scroll {
  overflow: hidden;
}
</style>
<body class="no-scroll">
  <!--<h1 class="space-mono-bold">Universal Yums</h1>-->
  <div>
    <img class="mx-auto max-h-[10vh] mt-2" src="{{ url_for('static', filename='images/SnackboxLogo.svg') }}"/> 
    <p class="text-center">User: {{ username }}</p>
    <p class="text-center">Is Admin: {{ isAdmin }}</p>
  </div>
  <main class="bg-[#0133a3] mt-2">
    <div class="overlay">Please wait for the game to start</div>
    <div class="mx-[400px]" id="image-container"></div>
  </main>
</body>
<script>
  // Fetch the JSON list of images
  function GetAllSnacks() { 
    fetch('/snackbox/image-list')
      .then(response => response.json())
      .then(images => {
          const container = document.getElementById('image-container');

          images.forEach(url => {
              const wrapper = document.createElement('div');
              wrapper.style.display = 'flex';
              wrapper.style.flexDirection = 'column';
              wrapper.style.alignItems = 'center';

              const img = document.createElement('img');
              img.src = "image/" + url;
              img.alt = 'url';
              container.appendChild(img);

              const fileName = url.split('/').pop() || '';
              const cleaned = fileName
              .replace(/\.(jpg|jpeg|png|gif)$/i, '') 
              .replace(/_/g, ' '); 

              const captionText = cleaned
              .split(' ')
              .map(word => word.charAt(0).toUpperCase() + word.slice(1))
              .join(' ');

              const caption = document.createElement('h3');
              caption.textContent = captionText;
              caption.classList.add("space-mono-bold");
              caption.style.color = "white";
              caption.style.textAlign = 'center';
              caption.style.wordBreak = 'break-word';

              wrapper.appendChild(img);
              wrapper.appendChild(caption);
              container.appendChild(wrapper);
          });
          
      })
      .catch(error => {
          console.error('Error fetching images:', error);
      });
  }
  GetAllSnacks();
</script>
  {% endblock %}
